\section{\IFRU{Предупреждения компилятора}{Compiler warnings}}

\IFRU{Стоит ли постоянно держать включенным ключ}{Is it worth to turn on} \TT{-Wall} \InENRU GCC 
\OrENRU \TT{/Wall} \InENRU MSVC, \IFRU{то есть, чтобы выводить
все возможные предупреждения (warnings)}{in other words, to dump all possible warnings}?
\IFRU{Да, однозначно стоит, так можно зараннее найти мелкие ошибки}{Yes, it is worth to do it,
in order to determine quickly small errors}.
\IFRU{Можно даже в GCC включить}{In GCC it is even possible to turn on} \TT{-Werror} \OrENRU \TT{/WX} 
\InENRU MSVC ~--- 
\IFRU{тогда предупреждения будут трактоваться как ошибки}{then warning will be treated as errors}.

\IFRU{Вот простой пример}{Here is a simple example}:

\begin{lstlisting}
#include <stdio.h>

int f1(int a, int b, int c)
{
	printf ("(in %s) %d\n", __FUNCTION__, a*b+c);
	// return a*b+c; // OOPS, accidentally I forgot to add this
};

int main()
{
	printf ("(in %s) %d\n", __FUNCTION__, f1(123,456,789));
};
\end{lstlisting}

\IFRU{Автор ``забыл'' дописать \IT{return} в ф-ции f1()}
{The author ``forgot'' to add \IT{return} in f1() function}.
\IFRU{Тем не менее}{Nevertheless}, GCC 4.8.1 \IFRU{компилирует этот пример молча}{compiles this silently}.
\IFRU{При запуске мы увидим это}{After running we will see this}:

\begin{lstlisting}
(in f1) 56877
(in main) 14
\end{lstlisting}

\IFRU{Откуда взялось число $14$}{Where the $14$ number is came from}?
Это то что вернула ф-ция printf() вызванная из f1().
Возвращаемые результаты ф-ций \glslink{integral type}{интегральных типов}
остаются в регистре EAX/RAX.
В ф-ции main() берется значение из регистра EAX/RAX и передается дальше во второй printf()
\footnote{Больше о том, как возвращаются результаты ф-ций через регистры, можно почитать в \cite{REBook}}.

Если компилировать с опцией -Wall, GCC скажет:

\begin{lstlisting}
1.c: In function 'f1':
1.c:7:1: warning: control reaches end of non-void function [-Wreturn-type]
 };
 ^
1.c: In function 'main':
1.c:12:1: warning: control reaches end of non-void function [-Wreturn-type]
 };
 ^
\end{lstlisting}

... хотя всё равно скомпилирует.

MSVC 2010 тоже генерирует код, работающий точно также, хотя и выводит предупреждение:

\begin{lstlisting}
...\1.c(7) : warning C4716: 'f1' : must return a value
\end{lstlisting}

Как видно, ошибка почти критическая, вызванная, можно сказать, опечаткой, но предупреждения компилятора
либо не видно вовсе, либо можно и не заметить.

