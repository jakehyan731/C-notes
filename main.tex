\documentclass[11pt,a4paper,oneside]{book}

\usepackage{cmap}

\ifdefined\RUSSIAN
\usepackage[english,russian]{babel}
\usepackage[T2A]{fontenc}
\usepackage{paratype}
\renewcommand*\familydefault{\sfdefault}
% http://www.emerson.emory.edu/services/latex/latex_169.html
\newcommand{\lstlistingsize}{\scriptsize}
\else
\usepackage[russian,english]{babel}
\usepackage[T2A]{fontenc}
\usepackage[default]{sourcesanspro}
\newcommand{\lstlistingsize}{\footnotesize}
\fi

\usepackage[utf8]{inputenc}
\usepackage{listings}
\usepackage{ulem}
\usepackage{url}
\usepackage{graphicx}
\usepackage{listingsutf8}
\usepackage{makeidx}
\usepackage{cite}
\usepackage[cm]{fullpage}
\usepackage{color}
\usepackage{fancyvrb}
\usepackage{xspace}
\usepackage{framed}
\usepackage{ccicons}
\usepackage[nottoc]{tocbibind}
\usepackage{amsmath}
\usepackage[table]{xcolor}% http://ctan.org/pkg/xcolor
\usepackage[]{hyperref} % should be last
%\usepackage{tikz}

\definecolor{lstbgcolor}{rgb}{0.94,0.94,0.94}
\makeindex

\include{macros}

\newcommand{\TITLE}{\IFRU{Заметки о языке программирования Си/Си++}
{C/C++ programming language notes}}
\newcommand{\AUTHOR}{\IFRU{Денис Юричев}{Dennis Yurichev}}
\newcommand{\EMAIL}{dennis@yurichev.com}

\hypersetup{
    pdftex,
    colorlinks=true,
    allcolors=blue,
    pdfauthor={\AUTHOR},
    pdftitle={\TITLE}
    }

\selectlanguage{english}

\lstset{
    backgroundcolor=\color{lstbgcolor},
    basicstyle=\ttfamily\lstlistingsize, 
    breaklines=true,
    frame=single,
    inputencoding=cp1251,
    columns=fullflexible,keepspaces,
}

\begin{document}

\VerbatimFootnotes

\frontmatter

\begin{titlepage}
\begin{center}
\vspace*{\fill}
\LARGE \TITLE

\vspace*{\fill}

\large \AUTHOR

\large \TT{<\EMAIL>}
\vspace*{\fill}
\vfill

\ccbyncnd

\textcopyright 2013, \AUTHOR. 

\IFRU{Это произведение доступно по лицензии Creative Commons «Attribution-NonCommercial-NoDerivs» 
(«Атрибуция — Некоммерческое использование — Без производных произведений») 3.0 Непортированная. 
Чтобы увидеть копию этой лицензии, посетите}
{This work is licensed under the Creative Commons Attribution-NonCommercial-NoDerivs 3.0 Unported License. 
To view a copy of this license, visit} \url{http://creativecommons.org/licenses/by-nc-nd/3.0/}.

\IFRU{Версия этого текста}{Text version} ({\large \today}).

\IFRU{Возможно, более новая версии текста, а так же англоязычная версия, также доступна по ссылке}
{Probably, newer version of this text, and also Russian language version is also accessible at} 
%FIXME URL?
\url{http://yurichev.com/C-notes.html}

\IFRU{Вы также можете подписаться на мой twitter для получения информации о новых версиях этого текста, итд:
\href{https://twitter.com/yurichev_ru}{@yurichev\_ru}}
{You may also subscribe to my twitter, to get information about updates of this text, etc: 
\href{https://twitter.com/yurichev}{@yurichev}}
%FIXME mailing list
\end{center}
\end{titlepage}

\tableofcontents
\cleardoublepage

\include{ad}

\cleardoublepage

\chapter{\IFRU{Введение}{Preface}}

Сейчас, в 2013-м году, если некто желает написать 1) как можно более быстро работающую программу; 2) либо как
можно более компактную для встраиваемых систем либо маломощных микроконтроллеров, то выбор небольшой:
Си, Си++ либо ассемблер. И альтернативы этим старым но популярным языкам, в обозримом будущем, 
пока что не видно.

\chapter{\IFRU{Целевая аудитория}{Target audience}}

Этот сборник заметок предназначен не для начинающих, но и не для экспертов, а скорее для тех, 
кто хочет освежить свои знания по Си/Си++.

\chapter{\IFRU{Об авторе}{About author}}

\IFRU{Денис Юричев ~--- опытный программист, свободный для найма как программист, reverse engineer, консультант, тренер. 
С его резюме можно ознакомиться \href{http://yurichev.com/Dennis_Yurichev.pdf}{здесь}.}
{Dennis Yurichev is experienced programmer, available for hire as programmer, reverse engineer, consultant, trainer. 
His CV is available \href{http://yurichev.com/Dennis_Yurichev.pdf}{here}.}

\chapter{\IFRU{Благодарности}{Thanks}}

\IFRU{Андрей ''herm1t'' Баранович, Слава ''Avid'' Казаков}
{Andrey ''herm1t'' Baranovich, Slava ''Avid'' Kazakov}.

\mainmatter

\chapter{\IFRU{Описания (definitions) в Си/Си++}{C/C++ definitions}}
\input{definitions_common_mistakes}
\input{const}
\input{datatypes}
\input{typedef}

\chapter{\IFRU{Объявления в Си/Си++}{C/C++ declarations}}
\section{Объявления переменных внутри ф-ции}

Раньше, в Си можно было объявлять переменные только в начале ф-ции. А в Си++ --- где угодно.

К тому же, нельзя было объявлять итератор в for() (а в Си++ также можно было):

\begin{lstlisting}
for(int i=0; i<10; i++)
	...
\end{lstlisting}

Новый стандарт\cite{C99TC3} позволяет делать это.

Впрочем, нужно отметить, что MSVC не поддерживает его. А чтобы включить его поддержку в GCC, нужно добавить ключ
компиляции \IT{-stc=c99}.

\subsection{static}

Обычно глобальные переменные (или ф-ции) объявляются как static, так их область видимости ограничивается 
данным файлом. Но локальные переменные внутри ф-ции также можно объявлять как static, тогда эта переменная
будет не локальной, а глобальной, но её область видимости будет ограничена только этой ф-цией.

К примеру, это помогло бы для реализации strtok(), ведь этой ф-ции что-то нужно хранить у себя между вызовами.

% forward declaration

\chapter{\IFRU{Элементы языка Си/Си++}{C/C++ language elements}}
\input{comments}
\input{goto}
\input{for}
\input{sizeof}
\input{pointers}
\input{operators}
\input{union}

\input{C99} % chapter

\input{preprocessor} % chapter

\input{C_strings} % chapter

\input{Cpp_templates} % chapter

% \chapter{\IFRU{Ваши собственные структуры данных}{Your own data structures}}
% list, map

\input{Cstdlib}

\include{afterword}

\bibliographystyle{alpha}
\bibliography{books,articles,usenet,misc}

\clearpage
\printindex

\end{document}

